<UserControl
    x:Class="DominatorUIUtility.CustomControl.Campaigns"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviours="clr-namespace:DominatorUIUtility.Behaviours"
    xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:converters="clr-namespace:DominatorHouseCore.Converters;assembly=DominatorHouseCore"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:interactivity="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:DominatorUIUtility.ViewModel"
    x:Name="Campaign"
    mc:Ignorable="d">

    <interactivity:Interaction.Triggers>
        <interactivity:EventTrigger EventName="Loaded">
            <interactivity:InvokeCommandAction Command="{Binding LoadedCommand}" />
        </interactivity:EventTrigger>
    </interactivity:Interaction.Triggers>

    <UserControl.Resources>
        <converters:IndexToRowNoConverter x:Key="IndexToRowNoConverter" />
        <converters:StringToBooleanConverter x:Key="StringToBooleanConverter" />
    </UserControl.Resources>

    <Border
        BorderBrush="{DynamicResource AccentBaseColorBrush}"
        BorderThickness="2"
        CornerRadius="5">
        <Grid Name="MainGrid">
            <Grid.RowDefinitions>
                <RowDefinition Height="40" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid Height="40" Background="{DynamicResource AccentBaseColorBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Grid.Column="0"
                    HorizontalAlignment="Left"
                    Orientation="Horizontal">
                    <Button
                        x:Name="DeleteMultipleCampaign"
                        Height="30"
                        HorizontalAlignment="Left"
                        VerticalContentAlignment="Center"
                        Background="Transparent"
                        Command="{Binding DeleteCommand}"
                        Cursor="Hand"
                        ToolTip="{DynamicResource LangKeyDeleteSelected}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <Rectangle
                                    Width="15"
                                    Height="20"
                                    Fill="IndianRed">
                                    <Rectangle.OpacityMask>
                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_delete}" />
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                                <TextBlock
                                    Margin="5,0"
                                    VerticalAlignment="Center"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    Foreground="White"
                                    Text="{DynamicResource LangKeyDeleteSelected}" />
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    <controls:ToggleSwitch
                        Margin="15,0,0,0"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        FocusVisualStyle="{x:Null}"
                        FontSize="12"
                        FontWeight="SemiBold"
                        Foreground="White"
                        IsChecked="{Binding AllCampStatus, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                        OffLabel="{DynamicResource LangKeyActiveAllSelectedCampaign}"
                        OnLabel="{DynamicResource LangKeyPauseAllSelectedCampaign}"
                        Style="{StaticResource MahApps.Metro.Styles.ToggleSwitch.Win10}">
                        <controls:ToggleSwitch.OnSwitchBrush>
                            <LinearGradientBrush>
                                <GradientStop Offset="0.0" Color="#FFFFC107" />
                                <!--  Amber  -->
                                <GradientStop Offset="1.0" Color="#FF673AB7" />
                                <!--  Deep Purple  -->
                            </LinearGradientBrush>
                        </controls:ToggleSwitch.OnSwitchBrush>
                        <controls:ToggleSwitch.OffSwitchBrush>
                            <LinearGradientBrush>
                                <GradientStop Offset="0.0" Color="#3E422B" />
                                <!--  Blue Grey  -->
                                <GradientStop Offset="1.0" Color="Wheat" />
                                <!--  Cyan  -->
                            </LinearGradientBrush>
                        </controls:ToggleSwitch.OffSwitchBrush>
                        <interactivity:Interaction.Triggers>
                            <interactivity:EventTrigger EventName="Click">
                                <interactivity:InvokeCommandAction Command="{Binding StatusChangeCommand}" />
                            </interactivity:EventTrigger>
                        </interactivity:Interaction.Triggers>
                    </controls:ToggleSwitch>
                    <CheckBox
                        x:Name="AllCampaign"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="White"
                        Content="Select All"
                        Cursor="Hand"
                        Foreground="White"
                        IsChecked="{Binding IsAllCampaignChecked}" />


                </StackPanel>
                <StackPanel
                    Grid.Column="1"
                    HorizontalAlignment="Left"
                    Orientation="Horizontal">
                    <Label
                        Height="25"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Content="{DynamicResource LangKeySearchCampaignByName}"
                        FontSize="12"
                        FontWeight="Bold"
                        Foreground="White" />
                    <TextBox
                        Height="25"
                        MinWidth="150"
                        MaxWidth="200"
                        Background="Transparent"
                        BorderBrush="White"
                        FontWeight="SemiBold"
                        Foreground="White"
                        Text="{Binding FilterByName, UpdateSourceTrigger=PropertyChanged}">
                        <interactivity:Interaction.Triggers>
                            <interactivity:EventTrigger EventName="TextChanged">
                                <interactivity:InvokeCommandAction Command="{Binding FilterByNameCommand}" />
                            </interactivity:EventTrigger>
                        </interactivity:Interaction.Triggers>
                    </TextBox>
                    <Label
                        Height="25"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Content="{DynamicResource LangKeySelectCampaignCategory}"
                        FontSize="12"
                        FontWeight="Bold"
                        Foreground="White" />
                    <ComboBox
                        x:Name="CmbCampaignType"
                        Height="26"
                        MinWidth="240"
                        Margin="3"
                        behaviours:SelectionChangedBehaviour.Command="{Binding CampaignTypeSelectionChange}"
                        Background="Transparent"
                        BorderBrush="White"
                        Foreground="White"
                        ItemsSource="{Binding CampaignModel.ActivityType}"
                        SelectedIndex="0"
                        SelectedItem="{Binding CampaignModel.SelectedActivity}"
                        ToolTip="{DynamicResource LangKeySelectTheCampaignToFilterForView}" />
                </StackPanel>

            </Grid>

            <ListView
                x:Name="list"
                Grid.Row="1"
                Width="Auto"
                HorizontalContentAlignment="Stretch"
                AlternationCount="{Binding Items.Count, RelativeSource={RelativeSource Self}}"
                Background="Transparent"
                ItemContainerStyle="{DynamicResource CampaignListViewStyle}"
                ItemsSource="{Binding CampaignCollection, IsAsync=True}"
                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                ScrollViewer.VerticalScrollBarVisibility="Auto"
                VirtualizingPanel.IsContainerVirtualizable="True"
                VirtualizingPanel.IsVirtualizing="True"
                VirtualizingPanel.VirtualizationMode="Recycling">
                <ListView.Resources>
                    <viewModel:BindingData x:Key="ContextMenuBinding" Data="{Binding}" />
                </ListView.Resources>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel VerticalAlignment="Top" Orientation="Vertical" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>

                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Border
                            Margin="3,3,3,0"
                            Padding="10,8"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Top"
                            Background="Transparent"
                            BorderBrush="{DynamicResource AccentBaseColorBrush}"
                            BorderThickness="1"
                            CornerRadius="8">

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <!--  Checkbox & Row Number  -->
                                    <CheckBox
                                        x:Name="ChkSingleCampaign"
                                        Grid.Column="0"
                                        HorizontalAlignment="Center"
                                        Background="White"
                                        Cursor="Hand"
                                        Foreground="{DynamicResource AccentBaseColorBrush}"
                                        IsChecked="{Binding IsCampaignChecked}"
                                        ToolTip="Select Campaign" />

                                    <!--  Campaign Name  -->
                                    <TextBlock
                                        Grid.Column="1"
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Foreground="{DynamicResource CampaignTextBgColor}"
                                        Text="{Binding CampaignName}"
                                        TextAlignment="Center"
                                        ToolTip="Campaign Name" />

                                    <!--  Module Name  -->
                                    <TextBlock
                                        Grid.Column="2"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        FontSize="16"
                                        Foreground="{DynamicResource CampaignTextBgColor}"
                                        Text="{Binding SubModule}"
                                        TextAlignment="Center"
                                        ToolTip="Campaign Submodule" />
                                </Grid>
                                <Grid Grid.Column="1" HorizontalAlignment="Left">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <!--  Status Toggle  -->
                                    <controls:ToggleSwitch
                                        Name="campaignStatus"
                                        Grid.Column="0"
                                        Margin="10,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        Cursor="Hand"
                                        FontSize="16"
                                        Foreground="{DynamicResource CampaignTextBgColor}"
                                        IsChecked="{Binding DataContext.Status, RelativeSource={RelativeSource AncestorType=Grid}, Converter={StaticResource StringToBooleanConverter}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        OffLabel="{DynamicResource LangKeyPaused}"
                                        OnLabel="{DynamicResource LangKeyActive}"
                                        ToolTip="Campaign Status">
                                        <controls:ToggleSwitch.OnSwitchBrush>
                                            <LinearGradientBrush>
                                                <GradientStop Offset="0.0" Color="#FFFFC107" />
                                                <!--  Amber  -->
                                                <GradientStop Offset="1.0" Color="#FF673AB7" />
                                                <!--  Deep Purple  -->
                                            </LinearGradientBrush>
                                        </controls:ToggleSwitch.OnSwitchBrush>
                                        <controls:ToggleSwitch.OffSwitchBrush>
                                            <LinearGradientBrush>
                                                <GradientStop Offset="0.0" Color="#75852A" />
                                                <!--  Blue Grey  -->
                                                <GradientStop Offset="1.0" Color="Wheat" />
                                                <!--  Cyan  -->
                                            </LinearGradientBrush>
                                        </controls:ToggleSwitch.OffSwitchBrush>
                                        <controls:ToggleSwitch.Style>
                                            <Style BasedOn="{StaticResource MahApps.Metro.Styles.ToggleSwitch.Win10}" TargetType="controls:ToggleSwitch">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding SelectedAccountList.Count}" Value="0">
                                                        <Setter Property="OffSwitchBrush" Value="#FA8072" />
                                                        <Setter Property="OnSwitchBrush" Value="#FA8072" />
                                                        <Setter Property="ToolTip" Value="*Account not present" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </controls:ToggleSwitch.Style>
                                        <interactivity:Interaction.Triggers>
                                            <interactivity:EventTrigger EventName="Click">
                                                <interactivity:InvokeCommandAction Command="{Binding DataContext.StatusChangeCommand, RelativeSource={RelativeSource AncestorType={x:Type ListView}}}" CommandParameter="{Binding ElementName=campaignStatus}" />
                                            </interactivity:EventTrigger>
                                        </interactivity:Interaction.Triggers>
                                    </controls:ToggleSwitch>

                                    <!--  Action Buttons  -->
                                    <StackPanel
                                        Grid.Column="1"
                                        Margin="0,0,0,0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <Button
                                            Name="BtnCampaignSetting"
                                            Width="38"
                                            Height="20"
                                            Background="Transparent"
                                            Command="{Binding DataContext.SettingCommand, RelativeSource={RelativeSource AncestorType={x:Type ListView}}}"
                                            CommandParameter="{Binding ElementName=BtnCampaignSetting}"
                                            Cursor="Hand"
                                            Style="{StaticResource ButtonStyle}"
                                            ToolTip="Campaign Action">
                                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                                <Rectangle
                                                    Width="18"
                                                    Height="18"
                                                    Fill="{DynamicResource CampaignTextBgColor}">
                                                    <Rectangle.OpacityMask>
                                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_settings}" />
                                                    </Rectangle.OpacityMask>
                                                </Rectangle>
                                            </StackPanel>

                                            <Button.ContextMenu>
                                                <ContextMenu>
                                                    <ContextMenu.Template>
                                                        <ControlTemplate TargetType="ContextMenu">
                                                            <Popup
                                                                x:Name="Popup"
                                                                AllowsTransparency="True"
                                                                Focusable="False"
                                                                IsOpen="{TemplateBinding IsOpen}"
                                                                Placement="Bottom"
                                                                PlacementTarget="{Binding PlacementTarget, RelativeSource={RelativeSource TemplatedParent}}">
                                                                <Border
                                                                    Margin="0,0,30,0"
                                                                    Padding="4"
                                                                    Background="{DynamicResource CardBackgroundBrush}"
                                                                    BorderBrush="{DynamicResource CampaignBGColor}"
                                                                    BorderThickness="2"
                                                                    CornerRadius="8"
                                                                    Effect="{DynamicResource ShadowEffect}"
                                                                    SnapsToDevicePixels="True">
                                                                    <StackPanel IsItemsHost="True" />
                                                                </Border>
                                                            </Popup>
                                                        </ControlTemplate>
                                                    </ContextMenu.Template>
                                                    <ContextMenu.Resources>
                                                        <!--  Card Background  -->
                                                        <SolidColorBrush x:Key="CardBackgroundBrush" Color="#FFFFFF" />
                                                        <!--  White card  -->

                                                        <!--  Text Brushes  -->
                                                        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#212121" />
                                                        <!--  Primary text  -->
                                                        <SolidColorBrush x:Key="TextDisabledBrush" Color="#9E9E9E" />
                                                        <!--  Disabled text  -->

                                                        <!--  Accent / Hover Brush  -->
                                                        <SolidColorBrush x:Key="AccentLightBrush" Color="#F5F5F5" />
                                                        <!--  Light hover color  -->

                                                        <!--  Icon Fill Brush (for vector icons)  -->
                                                        <SolidColorBrush x:Key="IconFillBrushAccordingTheme" Color="#424242" />
                                                        <!--  Dark grey icon fill  -->

                                                        <!--  Shadow Effect  -->
                                                        <DropShadowEffect
                                                            x:Key="ShadowEffect"
                                                            BlurRadius="8"
                                                            Direction="270"
                                                            Opacity="0.5"
                                                            ShadowDepth="2"
                                                            Color="#40000000" />
                                                        <!--  Style for menu items  -->
                                                        <Style TargetType="MenuItem">
                                                            <Setter Property="Padding" Value="12,6" />
                                                            <Setter Property="Height" Value="36" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                            <Setter Property="FontFamily" Value="Segoe UI" />
                                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
                                                            <Setter Property="Background" Value="Transparent" />
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="MenuItem">
                                                                        <Border
                                                                            x:Name="Border"
                                                                            Background="{TemplateBinding Background}"
                                                                            CornerRadius="4">
                                                                            <Grid>
                                                                                <Grid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="30" />
                                                                                    <ColumnDefinition Width="*" />
                                                                                </Grid.ColumnDefinitions>
                                                                                <ContentPresenter
                                                                                    Grid.Column="0"
                                                                                    HorizontalAlignment="Center"
                                                                                    VerticalAlignment="Center"
                                                                                    ContentSource="Icon" />
                                                                                <ContentPresenter
                                                                                    Grid.Column="1"
                                                                                    VerticalAlignment="Center"
                                                                                    ContentSource="Header" />
                                                                            </Grid>
                                                                        </Border>
                                                                        <ControlTemplate.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource AccentLightBrush}" />
                                                                            </Trigger>
                                                                            <Trigger Property="IsEnabled" Value="False">
                                                                                <Setter Property="Foreground" Value="{DynamicResource TextDisabledBrush}" />
                                                                            </Trigger>
                                                                        </ControlTemplate.Triggers>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </ContextMenu.Resources>

                                                    <!--  Your Menu Items  -->
                                                    <MenuItem
                                                        Command="{Binding Data.EditCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyEdit}">
                                                        <MenuItem.Icon>
                                                            <Rectangle
                                                                Width="20"
                                                                Height="20"
                                                                Fill="{DynamicResource IconFillBrushAccordingTheme}">
                                                                <Rectangle.OpacityMask>
                                                                    <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_edit_box}" />
                                                                </Rectangle.OpacityMask>
                                                            </Rectangle>
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <MenuItem
                                                        Command="{Binding Data.DuplicateCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyDuplicateCampaign}">
                                                        <MenuItem.Icon>
                                                            <Rectangle
                                                                Width="17"
                                                                Height="16"
                                                                Fill="{DynamicResource IconFillBrushAccordingTheme}">
                                                                <Rectangle.OpacityMask>
                                                                    <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_page_duplicate}" />
                                                                </Rectangle.OpacityMask>
                                                            </Rectangle>
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <Separator />

                                                    <MenuItem
                                                        Command="{Binding Data.DeleteCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyDelete}">
                                                        <MenuItem.Icon>
                                                            <Rectangle
                                                                Width="15"
                                                                Height="20"
                                                                Fill="{DynamicResource IconFillBrushAccordingTheme}">
                                                                <Rectangle.OpacityMask>
                                                                    <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_delete}" />
                                                                </Rectangle.OpacityMask>
                                                            </Rectangle>
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <Separator />

                                                    <MenuItem
                                                        Command="{Binding Data.ReportCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyReport}">
                                                        <MenuItem.Icon>
                                                            <Image
                                                                Width="20"
                                                                Height="20"
                                                                Source="/DominatorUIUtility;component/Images/black_PostList.png" />
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <MenuItem
                                                        Command="{Binding Data.ExportReportCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyExportReport}">
                                                        <MenuItem.Icon>
                                                            <Rectangle
                                                                Width="17"
                                                                Height="16"
                                                                Fill="{DynamicResource IconFillBrushAccordingTheme}">
                                                                <Rectangle.OpacityMask>
                                                                    <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_inbox_out}" />
                                                                </Rectangle.OpacityMask>
                                                            </Rectangle>
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <Separator />

                                                    <MenuItem
                                                        Command="{Binding Data.CopyCampaignIdCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeyCopyCampaignId}">
                                                        <MenuItem.Icon>
                                                            <Rectangle
                                                                Width="17"
                                                                Height="16"
                                                                Fill="{DynamicResource IconFillBrushAccordingTheme}">
                                                                <Rectangle.OpacityMask>
                                                                    <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_page_copy}" />
                                                                </Rectangle.OpacityMask>
                                                            </Rectangle>
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                    <Separator />

                                                    <MenuItem
                                                        Command="{Binding Data.SelectedAccountsCommand, Source={StaticResource ContextMenuBinding}}"
                                                        CommandParameter="{Binding}"
                                                        Header="{DynamicResource LangKeySelectedAccounts}">
                                                        <MenuItem.Icon>
                                                            <Image
                                                                Width="20"
                                                                Height="20"
                                                                Source="/DominatorUIUtility;component/Images/groupupdate.png" />
                                                        </MenuItem.Icon>
                                                    </MenuItem>

                                                </ContextMenu>
                                            </Button.ContextMenu>

                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <controls:FlyoutsControl Grid.Row="1">
                <controls:Flyout
                    Name="SelectedAccountFlyout"
                    BorderBrush="{DynamicResource AccentColorBrush2}"
                    BorderThickness="1"
                    Header="{Binding SelectedAccountListCampaign}"
                    IsOpen="{Binding SelectedAccountsFlyoutVisibility}"
                    Position="Right">
                    <ListBox
                        FontSize="14"
                        ItemsSource="{Binding SelectedAccountList}"
                        ScrollViewer.VerticalScrollBarVisibility="Auto" />
                </controls:Flyout>
            </controls:FlyoutsControl>

        </Grid>

    </Border>

</UserControl>