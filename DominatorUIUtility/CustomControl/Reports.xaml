<UserControl
    x:Class="DominatorUIUtility.CustomControl.Reports"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:converters="clr-namespace:DominatorHouseCore.Converters;assembly=DominatorHouseCore"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:utility="clr-namespace:DominatorHouseCore.Utility;assembly=DominatorHouseCore"
    x:Name="ReportsControl"
    mc:Ignorable="d">

    <UserControl.Resources>
        <converters:ListCountVisiblityConverter x:Key="ListCountVisiblityConverter" />
    </UserControl.Resources>
    <Grid Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="3*" />
        </Grid.RowDefinitions>
        <Grid>
            <CheckBox
                x:Name="ChkFilter"
                Margin="10"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Content="{DynamicResource LangKeyFilter}"
                Visibility="Collapsed" />
            <StackPanel
                x:Name="PaginationControl"
                Margin="0,10,0,0"
                HorizontalAlignment="Left"
                Orientation="Horizontal"
                Visibility="Visible">
                <Button
                    x:Name="BtnLoadPrevious"
                    Margin="5,0"
                    Background="Transparent"
                    Click="LoadPrevious"
                    Cursor="Hand"
                    IsEnabled="{Binding ReportModel.LoadPreviousEnable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <Button.Content>
                        <Viewbox Width="30" Height="30">
                            <Canvas
                                Width="489"
                                Height="489"
                                RenderTransformOrigin="0.5,0.5">
                                <Canvas.RenderTransform>
                                    <ScaleTransform ScaleX="-1" ScaleY="1" />
                                </Canvas.RenderTransform>
                                <!--  First path  -->
                                <Path
                                    Data="M417.4,71.6C371.2,25.4,309.8,0,244.5,0S117.8,25.4,71.6,71.6C27.9,117.9,2,179.0,2,244.5s25.9,126.7,71.6,172.9             c45.9,45.2,107.3,70.4,172.9,70.4s126.7-25.2,172.9-70.4c45.2-45.2,70.4-107.3,70.4-172.9S462.4,117.8,417.4,71.6z"
                                    Fill="Transparent"
                                    Stroke="White"
                                    StrokeEndLineCap="Round"
                                    StrokeLineJoin="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeThickness="15" />

                                <!--  Second path  -->
                                <Path
                                    Data="M236.1,169.2c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l56.2,56.2l-56.2,56.2c-5.3,5.3-5.3,13.8,0,19.1            c5.3,5.3,13.8,5.3,19.1,0l65.7-65.7c5.3-5.3,5.3-13.8,0-19.1L236.1,169.2z"
                                    Fill="Transparent"
                                    Stroke="White"
                                    StrokeEndLineCap="Round"
                                    StrokeLineJoin="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeThickness="15" />


                            </Canvas>
                        </Viewbox>


                    </Button.Content>

                </Button>

                <TextBlock
                    Margin="5,0"
                    VerticalAlignment="Center"
                    Foreground="White"
                    Text="Page" />
                <!--<ComboBox ItemsSource="{Binding PageNumbers}" SelectedItem="{Binding CurrentPageNumber}" Width="60"/>-->
                <TextBlock
                    Margin="5,0"
                    VerticalAlignment="Center"
                    Foreground="White"
                    Text="{Binding ReportModel.CurrentPage, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                <TextBlock
                    Margin="5,0"
                    VerticalAlignment="Center"
                    Foreground="White"
                    Text="of" />
                <TextBlock
                    Margin="5,0"
                    VerticalAlignment="Center"
                    Foreground="White"
                    Text="{Binding ReportModel.TotalPages, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    x:Name="LoadNEXT"
                    Margin="5,0"
                    Background="Transparent"
                    Click="LoadNext"
                    Cursor="Hand"
                    IsEnabled="{Binding ReportModel.LoadNextEnable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <Button.Content>
                        <Viewbox Width="30" Height="30">
                            <Canvas Width="489" Height="489">

                                <!--  First path  -->
                                <Path
                                    Data="M417.4,71.6C371.2,25.4,309.8,0,244.5,0S117.8,25.4,71.6,71.6C27.9,117.9,2,179.0,2,244.5s25.9,126.7,71.6,172.9             c45.9,45.2,107.3,70.4,172.9,70.4s126.7-25.2,172.9-70.4c45.2-45.2,70.4-107.3,70.4-172.9S462.4,117.8,417.4,71.6z"
                                    Fill="Transparent"
                                    Stroke="White"
                                    StrokeEndLineCap="Round"
                                    StrokeLineJoin="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeThickness="15" />

                                <!--  Second path  -->
                                <Path
                                    Data="M236.1,169.2c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l56.2,56.2l-56.2,56.2c-5.3,5.3-5.3,13.8,0,19.1            c5.3,5.3,13.8,5.3,19.1,0l65.7-65.7c5.3-5.3,5.3-13.8,0-19.1L236.1,169.2z"
                                    Fill="Transparent"
                                    Stroke="White"
                                    StrokeEndLineCap="Round"
                                    StrokeLineJoin="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeThickness="15" />

                            </Canvas>
                        </Viewbox>


                    </Button.Content>
                </Button>
                <StackPanel Orientation="Horizontal">
                    <TextBlock
                        Margin="5,0"
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="White"
                        Text="Total Report Count : " />
                    <TextBlock
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="White"
                        Text="{Binding ReportModel.TotalReportCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </StackPanel>
                <!--<Border
                Width="auto"
                Margin="5,0"
                VerticalAlignment="Center"
                BorderBrush="{DynamicResource TextColorBrushAccordingTheme}"
                BorderThickness="1"
                CornerRadius="5">
                <ComboBox
                Margin="3,0"
                VerticalAlignment="Center"
                VerticalContentAlignment="Center"
                Background="{DynamicResource AccentColorBrush2}"
                BorderBrush="{DynamicResource AccentColorBrush2}"
                BorderThickness="0"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                ItemsSource="{Binding PageSizeOptions}"
                SelectedItem="{Binding ItemsPerPage}">
                <ComboBox.ItemContainerStyle>
                <Style TargetType="ComboBoxItem">
                <Setter Property="Background" Value="{DynamicResource TextColorBrushAccordingTheme}" />
                <Setter Property="Foreground" Value="{DynamicResource AccentColorBrush2}" />
                <Setter Property="HorizontalContentAlignment" Value="Left" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                -->
                <!--  Optional: highlight item on mouse over  -->
                <!--
                <Setter Property="Template">
                <Setter.Value>
                <ControlTemplate TargetType="ComboBoxItem">
                <Border
                Background="{TemplateBinding Background}"
                BorderBrush="{DynamicResource AccentColorBrush2}"
                BorderThickness="0,1,0,0">
                <ContentPresenter
                Margin="2"
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                </Border>
                </ControlTemplate>
                </Setter.Value>
                </Setter>
                <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                <Setter Property="Foreground" Value="{DynamicResource AccentColorBrush3}" />
                -->
                <!--  Optional: Different background when selected  -->
                <!-- <Setter Property="Background" Value="{DynamicResource SomeSelectedBackgroundBrush}" /> -->
                <!--
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource AccentColorBrush2}" />
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrushAccordingTheme}" />
                </Trigger>
                </Style.Triggers>
                </Style>
                </ComboBox.ItemContainerStyle>
                <ComboBox.ItemTemplate>
                <DataTemplate>
                <TextBlock
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Text="{Binding}" />
                </DataTemplate>
                </ComboBox.ItemTemplate>
                </ComboBox>
                </Border>-->

            </StackPanel>

            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <Border
                    Margin="0,0,5,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    BorderBrush="White"
                    BorderThickness="1"
                    CornerRadius="5"
                    Visibility="{Binding ReportModel.FollowRate, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Button
                        Background="Transparent"
                        Click="ClkFollowRate"
                        Foreground="White">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <Rectangle
                                    Width="12"
                                    Height="15"
                                    VerticalAlignment="Center"
                                    Fill="White"
                                    ToolTip="{DynamicResource LangKeyFollowRate}">
                                    <Rectangle.OpacityMask>
                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_refresh}" />
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                                <TextBlock Margin="5,0" Text="{DynamicResource LangKeyFollowRate}" />
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Border>

                <Button
                    Click="RefreshReport"
                    Cursor="Hand"
                    Foreground="White"
                    ToolTip="{DynamicResource LangKeyRefresh}">
                    <Button.Template>
                        <ControlTemplate>
                            <Border
                                x:Name="RefreshBtnBorder"
                                Height="35"
                                Background="Green"
                                BorderBrush="White"
                                BorderThickness="1"
                                CornerRadius="5">
                                <StackPanel Margin="15,5" Orientation="Horizontal">
                                    <Rectangle
                                        Width="12"
                                        Height="15"
                                        VerticalAlignment="Center"
                                        Fill="White">
                                        <Rectangle.OpacityMask>
                                            <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_refresh}" />
                                        </Rectangle.OpacityMask>
                                    </Rectangle>
                                    <TextBlock
                                        Margin="5,0,0,0"
                                        VerticalAlignment="Center"
                                        Foreground="White"
                                        Text="{DynamicResource LangKeyRefresh}" />
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="RefreshBtnBorder" Property="Background" Value="LimeGreen" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>



                <Button
                    x:Name="ExportReport"
                    Margin="15,0"
                    x:FieldModifier="public"
                    Click="ExportReport_Click"
                    Cursor="Hand"
                    ToolTip="Export in CSV">

                    <Button.Template>
                        <ControlTemplate>
                            <Border
                                x:Name="ExportBtnBorder"
                                Height="35"
                                Background="{DynamicResource AccentColorBrush}"
                                BorderBrush="White"
                                BorderThickness="1"
                                CornerRadius="5">
                                <StackPanel Margin="15,5" Orientation="Horizontal">
                                    <Rectangle
                                        Width="16"
                                        Height="15"
                                        VerticalAlignment="Center"
                                        Fill="White">
                                        <Rectangle.OpacityMask>
                                            <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_inbox_out}" />
                                        </Rectangle.OpacityMask>
                                    </Rectangle>
                                    <TextBlock
                                        Margin="5,0,0,0"
                                        VerticalAlignment="Center"
                                        Foreground="White"
                                        Text="{DynamicResource LangKeyExport}" />
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="ExportBtnBorder" Property="Background" Value="{DynamicResource DarkBlueBrush}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

            </StackPanel>
        </Grid>

        <StackPanel
            Grid.Row="1"
            HorizontalAlignment="Center"
            Orientation="Horizontal"
            Visibility="Collapsed">
            <!--  Visibility="{Binding IsChecked, ElementName=ChkFilter,Converter={StaticResource BooleanToVisibilityConverter}}">  -->
            <ComboBox
                x:Name="CmbAccounts"
                Width="130"
                Margin="10,0,0,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeySelectAccountS}"
                x:FieldModifier="public"
                ItemsSource="{Binding ReportModel.AccountList}"
                Visibility="{Binding ReportModel.AccountList, Converter={StaticResource ListCountVisiblityConverter}}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <CheckBox
                            Name="AccountCheckBox"
                            Content="{Binding Content}"
                            IsChecked="{Binding IsContentSelected}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <ComboBox
                x:Name="CmbQueries"
                Width="130"
                Margin="8,0,0,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeySelectQuery}"
                x:FieldModifier="public"
                ItemsSource="{Binding ReportModel.QueryList}"
                Visibility="{Binding ReportModel.QueryList, Converter={StaticResource ListCountVisiblityConverter}}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <CheckBox
                            Name="QueryCheckBox"
                            Content="{Binding Content}"
                            IsChecked="{Binding IsContentSelected}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <DatePicker
                Width="130"
                Margin="8,0,0,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyStartDate}" />
            <DatePicker
                Width="130"
                Margin="8,0,0,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyEndDate}" />
            <ComboBox
                x:Name="CmbStatus"
                Width="130"
                Margin="8,0,10,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyStatus}"
                x:FieldModifier="public"
                ItemsSource="{Binding ReportModel.StatusList}"
                Visibility="{Binding ReportModel.StatusList, Converter={StaticResource ListCountVisiblityConverter}}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <CheckBox
                            Name="StatusCheckBox"
                            Content="{Binding Content}"
                            IsChecked="{Binding IsContentSelected}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </StackPanel>

        <ListView
            Name="ReportsListView"
            Grid.Row="2"
            Margin="5"
            Foreground="{DynamicResource AccentBaseColorBrush}"
            ItemsSource="{Binding ReportModel.ReportCollection, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, IsAsync=True}"
            ScrollViewer.IsDeferredScrollingEnabled="True"
            VirtualizingStackPanel.IsVirtualizing="True"
            VirtualizingStackPanel.VirtualizationMode="Recycling">
            <ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ListViewItem}">
                                <Grid Background="{TemplateBinding Background}">
                                    <Border Name="Selection" Visibility="Collapsed" />
                                    <!--  This is used when GridView is put inside the ListView  -->
                                    <GridViewRowPresenter
                                        Grid.RowSpan="2"
                                        Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />

                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="MinHeight" Value="27" />
                    <Setter Property="Height" Value="Auto" />
                    <Setter Property="MaxHeight" Value="100" />
                    <Setter Property="Focusable" Value="False" />
                    <Setter Property="Foreground" Value="{DynamicResource TextColorBrushAccordingTheme1}" />
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{DynamicResource ListItemsMouseHoverColorAccordingTheme}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="False">
                            <Setter Property="Background" Value="Transparent" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView
                    utility:GridViewColumns.ColumnBinding="ColumnBindingText"
                    utility:GridViewColumns.ColumnHeader="ColumnHeaderText"
                    utility:GridViewColumns.ColumnValues="{Binding ReportModel.GridViewColumn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            </ListView.View>
        </ListView>

    </Grid>

</UserControl>