<UserControl
    x:Class="DominatorUIUtility.CustomControl.AddOrUpdateProxyControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:passwordHelper="clr-namespace:DominatorUIUtility.Behaviours"
    xmlns:validation="clr-namespace:DominatorHouseCore.Utility;assembly=DominatorHouseCore"
    mc:Ignorable="d">

    <Grid
        Name="MainGrid"
        Margin="0,30,0,10"
        VerticalAlignment="Center">
        <Grid.Resources>
            <ControlTemplate x:Key="ErrorTemplate">
                <StackPanel Orientation="Vertical">
                    <AdornedElementPlaceholder x:Name="ErrorHolder">
                        <Border BorderBrush="red" BorderThickness="1" />
                    </AdornedElementPlaceholder>
                    <TextBlock
                        Margin="5,0,0,10"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Foreground="Red"
                        Text="{Binding ElementName=ErrorHolder, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}" />
                </StackPanel>
            </ControlTemplate>
        </Grid.Resources>

        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />

        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyGroup"
                Width="120"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyGroup}" />
            <TextBox
                Name="txtProxyGroup"
                Grid.Column="1"
                Width="230"
                Height="30"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource GreenColorAccordingTheme}"
                KeyDown="OnKeyDown"
                Text="{Binding AccountProxy.ProxyGroup}" />
        </Grid>
        <Grid Grid.Row="1" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyName"
                Width="120"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyName}" />
            <TextBox
                Name="txtProxyName"
                Grid.Column="1"
                Width="230"
                Height="30"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                KeyDown="OnKeyDown"
                Text="{Binding AccountProxy.ProxyName}" />
        </Grid>

        <Grid Grid.Row="2" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyAddress"
                Width="120"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyAddress}" />
            <TextBox
                Name="txtProxyAddress"
                Grid.Column="1"
                Width="230"
                Height="30"
                Margin="5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyTypeProxyIp}"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                KeyDown="OnKeyDown"
                Validation.ErrorTemplate="{StaticResource ErrorTemplate}">
                <TextBox.Text>
                    <Binding Path="AccountProxy.ProxyIp" UpdateSourceTrigger="PropertyChanged">
                        <Binding.ValidationRules>
                            <validation:ProxyValidationHelper Sender="txtProxyAddress" ValidatesOnTargetUpdated="True" />
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>
        </Grid>
        <Grid Grid.Row="3" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyPort"
                Width="120"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyPort}" />
            <TextBox
                Name="txtProxyPort"
                Grid.Column="1"
                Width="230"
                Height="30"
                Margin="5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyTypeProxyPort}"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                KeyDown="OnKeyDown"
                Validation.ErrorTemplate="{StaticResource ErrorTemplate}">
                <TextBox.Text>
                    <Binding Path="AccountProxy.ProxyPort" UpdateSourceTrigger="PropertyChanged">
                        <Binding.ValidationRules>
                            <validation:ProxyValidationHelper Sender="txtProxyPort" ValidatesOnTargetUpdated="True" />
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>


        </Grid>
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyUserName"
                Width="120"
                Margin="5"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyUsername}" />
            <TextBox
                Name="txtProxyUserName"
                Grid.Column="1"
                Width="230"
                Height="30"
                Margin="5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyTypeProxyUsername}"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                IsEnabled="{Binding IsEnabled, ElementName=btnSave}"
                KeyDown="OnKeyDown"
                Text="{Binding AccountProxy.ProxyUsername}" />
        </Grid>
        <Grid Grid.Row="5" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2.5*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Name="txtblockProxyPassword"
                Width="120"
                Margin="5,11"
                VerticalAlignment="Center"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="White"
                Text="{DynamicResource LangKeyProxyPassword}" />
            <PasswordBox
                Name="txtProxyPassword"
                Grid.Column="1"
                Grid.ColumnSpan="1"
                Width="230"
                Height="30"
                Margin="5,5,4.693,5"
                VerticalAlignment="Center"
                controls:TextBoxHelper.Watermark="{DynamicResource LangKeyTypeProxyPassword}"
                passwordHelper:PasswordBoxHelper.Attach="True"
                FontSize="13"
                FontWeight="SemiBold"
                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                IsEnabled="{Binding IsEnabled, ElementName=btnSave}"
                KeyDown="OnKeyDown"
                Style="{StaticResource MetroButtonRevealedPasswordBox}">

                <passwordHelper:PasswordBoxHelper.Password>
                    <Binding
                        Mode="TwoWay"
                        Path="AccountProxy.ProxyPassword"
                        UpdateSourceTrigger="PropertyChanged" />
                </passwordHelper:PasswordBoxHelper.Password>
            </PasswordBox>

        </Grid>
        <Grid
            Grid.Row="6"
            Margin="0,10,0,0"
            HorizontalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <StackPanel
                Grid.Column="1"
                Margin="0,10,0,0"
                HorizontalAlignment="Center"
                Orientation="Horizontal">
                <Border
                    MinWidth="150"
                    Margin="0,0,0,10"
                    BorderBrush="White"
                    BorderThickness="1"
                    CornerRadius="5"
                    Cursor="Hand">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Setter Property="IsEnabled" Value="false" />
                            <Setter Property="Background" Value="Transparent" />
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding ElementName=txtProxyPort, Path=(Validation.HasError)}" Value="false" />
                                        <Condition Binding="{Binding ElementName=txtProxyAddress, Path=(Validation.HasError)}" Value="false" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="IsEnabled" Value="true" />
                                    <Setter Property="Background" Value="Green" />
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Button
                        x:Name="btnSave"
                        x:FieldModifier="public"
                        Background="Transparent"
                        Click="BtnSave_OnClick"
                        Content="{DynamicResource LangKeySave}"
                        Foreground="White" />
                </Border>
                <Border
                    MinWidth="150"
                    Margin="10,0,0,10"
                    Background="#ef1d1d"
                    BorderBrush="White"
                    BorderThickness="1"
                    CornerRadius="5"
                    Cursor="Hand">
                    <Button
                        x:Name="btnCancel"
                        x:FieldModifier="public"
                        Background="Transparent"
                        Click="BtnCancel_OnClick"
                        IsCancel="True">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <Rectangle
                                    Width="15"
                                    Height="15"
                                    Fill="White">
                                    <Rectangle.OpacityMask>
                                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_cancel}" />
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                                <TextBlock
                                    Margin="6,0"
                                    Foreground="White"
                                    Text="{DynamicResource LangKeyCancel}" />
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Border>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>