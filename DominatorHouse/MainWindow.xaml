<Window
    x:Class="Socinator.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:converter="clr-namespace:DominatorHouseCore.Converters;assembly=DominatorHouseCore"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dragable="http://dragablz.net/winfx/xaml/dragablz"
    xmlns:enums="clr-namespace:DominatorHouseCore.Enums;assembly=DominatorHouseCore"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:DominatorHouseCore.Models;assembly=DominatorHouseCore"
    xmlns:regions="http://prismlibrary.com/"
    xmlns:view="clr-namespace:DominatorUIUtility.CustomControl;assembly=DominatorUIUtility"
    xmlns:views="clr-namespace:DominatorHouse.Support.Logs.Views"
    Name="SocinatorWindow"
    MinWidth="700"
    MinHeight="550"
    Background="#D1D4E6"
    MouseLeftButtonDown="OnLeftButtonDown"
    Opacity="{Binding Opacity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
    SizeChanged="OnSizeChanged"
    WindowStartupLocation="CenterScreen"
    WindowState="Maximized"
    mc:Ignorable="d">
    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="0"
            CornerRadius="30"
            GlassFrameThickness="0"
            UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>
    <!--<Window.Effect>
    <DropShadowEffect
    BlurRadius="5"
    Direction="270"
    ShadowDepth="5"
    Color="Green" />
    </Window.Effect>-->
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Dragablz;component/Themes/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <Style TargetType="{x:Type dragable:TabablzControl}">
                <Setter Property="ItemContainerStyle" Value="{StaticResource TrapezoidDragableTabItemStyle}" />
            </Style>
            <converter:BooleanToAutomationStatusConverter x:Key="BooleanToVisibility" />
            <converter:SocialNetworkToVisualBrushConverter x:Key="SocialNetworkToVisualBrushConverter" />
            <converter:SocialNetworkToColorBrushConverter x:Key="SocialNetworkToColorBrushConverter" />
            <converter:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <converter:BoolToValueConverter
                x:Key="BoolToValueConverter"
                FalseValue="Light"
                TrueValue="Dark" />
        </ResourceDictionary>
    </Window.Resources>
    <Border
        x:Name="OuterBorder"
        Background="{DynamicResource UserControlBackgroundBrush}"
        BorderBrush="Transparent"
        BorderThickness="2"
        CornerRadius="10"
        SnapsToDevicePixels="True">
        <Grid x:Name="MainGrid">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Border
                Grid.Row="0"
                Margin="5,0,5,5"
                Padding="5"
                BorderBrush="{DynamicResource TextColorBrushAccordingTheme1}"
                BorderThickness="0,0,0,1.5">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel
                        Grid.Column="0"
                        Margin="10,0"
                        Orientation="Horizontal">
                        <Image
                            Width="35"
                            Height="35"
                            Source="/SociNator.ico" />
                        <TextBlock
                            Margin="10,0"
                            VerticalAlignment="Center"
                            FontFamily="Lucida Sans"
                            FontSize="20"
                            Foreground="{DynamicResource CampaignTextBgColor}"
                            Text="{Binding AvailableNetworks.Selected, StringFormat={}{0} Dominator}" />
                    </StackPanel>
                    <StackPanel
                        Grid.Column="2"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                        <StackPanel Orientation="Horizontal">
                            <ToggleButton
                                x:Name="ThemeToggleButton"
                                Width="45"
                                Height="20"
                                Margin="15,0,0,0"
                                Checked="OnChecked"
                                Cursor="Hand"
                                IsChecked="{Binding IsDark, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                Unchecked="OnUnChecked">
                                <ToggleButton.Style>
                                    <Style TargetType="ToggleButton">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Border
                                                        x:Name="Border"
                                                        Padding="3,2,3,2"
                                                        Background="Gray"
                                                        CornerRadius="10">
                                                        <Grid>
                                                            <Ellipse
                                                                x:Name="toggleCircle"
                                                                Width="12"
                                                                Height="12"
                                                                HorizontalAlignment="Left"
                                                                Fill="White" />
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                        </Grid>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="Border" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush>
                                                                        <GradientStop Offset="0.0" Color="#FFFFC107" />
                                                                        <!--  Amber  -->
                                                                        <GradientStop Offset="1.0" Color="#FF673AB7" />
                                                                        <!--  Deep Purple  -->
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter Property="TextBlock.Text" Value="Dark" />
                                                            <Setter TargetName="toggleCircle" Property="HorizontalAlignment" Value="Right" />
                                                        </Trigger>
                                                        <Trigger Property="IsChecked" Value="False">
                                                            <Setter TargetName="Border" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush>
                                                                        <GradientStop Offset="0.0" Color="#278D91" />
                                                                        <!--  Blue Grey  -->
                                                                        <GradientStop Offset="1.0" Color="#92B4C4" />
                                                                        <!--  Cyan  -->
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter Property="TextBlock.Text" Value="Light" />
                                                            <Setter TargetName="toggleCircle" Property="HorizontalAlignment" Value="Left" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ToggleButton.Style>
                            </ToggleButton>
                            <TextBlock
                                Margin="8,0,8,0"
                                VerticalAlignment="Center"
                                FontFamily="{DynamicResource RubikRegular}"
                                FontSize="14"
                                Foreground="{DynamicResource TextColorBrushAccordingTheme}"
                                Text="{Binding ElementName=ThemeToggleButton, Path=IsChecked, Converter={StaticResource BoolToValueConverter}}" />
                        </StackPanel>
                        <DockPanel Grid.Row="0">
                            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                <!--  Minimize  -->
                                <Button
                                    Width="40"
                                    Height="30"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="Minimize_Click"
                                    Cursor="Hand"
                                    ToolTip="Minimize">
                                    <Path
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M 0 0 L 10 0"
                                        Stroke="{DynamicResource TextColorBrushAccordingTheme}"
                                        StrokeThickness="2" />
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="AliceBlue" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <!--  Maximize / Restore  -->
                                <Button
                                    x:Name="MaxRestoreButton"
                                    Width="40"
                                    Height="30"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="MaxRestore_Click"
                                    Cursor="Hand"
                                    ToolTip="Maximize/Restore">
                                    <Path
                                        x:Name="MaxRestorePath"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M 0 0 L 0 10 L 10 10 L 10 0 Z"
                                        Fill="Transparent"
                                        Stroke="{DynamicResource TextColorBrushAccordingTheme}"
                                        StrokeThickness="2" />
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="AliceBlue" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <!--  Close  -->
                                <Button
                                    Width="40"
                                    Height="30"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="Close_Click"
                                    Cursor="Hand"
                                    ToolTip="Close">
                                    <Path
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M 0 0 L 10 10 M 10 0 L 0 10"
                                        StrokeThickness="2">
                                        <Path.Style>
                                            <Style TargetType="Path">
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Stroke" Value="Red" />
                                                    </Trigger>
                                                    <Trigger Property="IsMouseOver" Value="False">
                                                        <Setter Property="Stroke" Value="{DynamicResource TextColorBrushAccordingTheme}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>
                                    </Path>
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="AliceBlue" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </DockPanel>
                    </StackPanel>
                </Grid>
            </Border>

            <!--  Loader  -->
            <view:Loader
                Grid.Row="2"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Visibility="{Binding IsValidating, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource BooleanToVisibilityConverter}}" />
            <!--  Networks  -->
            <ListView
                Grid.Row="1"
                Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="0"
                DataContext="{Binding AvailableNetworks}"
                Foreground="White"
                ItemsSource="{Binding ItemsCollection}"
                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                SelectedItem="{Binding Selected}">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Padding" Value="0" />
                        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                        <Setter Property="OverridesDefaultStyle" Value="True" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListViewItem">
                                    <Border
                                        x:Name="Border"
                                        Margin="5,5,0,0"
                                        BorderBrush="{DynamicResource TextColorBrushAccordingTheme}"
                                        BorderThickness="1"
                                        CornerRadius="7"
                                        Opacity="0.6"
                                        SnapsToDevicePixels="True">
                                        <ContentPresenter />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <!--  Selected item gets thicker blue border  -->
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource TabBorderSolidBrush}">
                                                <!--<Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Offset="0.0" Color="#FF6200EA" />
                                                -->
                                                <!--  Deep Purple  -->
                                                <!--
                                                <GradientStop Offset="1.0" Color="#FF03DAC5" />
                                                -->
                                                <!--  Teal Accent  -->
                                                <!--
                                                </LinearGradientBrush>
                                                </Setter.Value>-->
                                            </Setter>

                                            <!--<Setter TargetName="Border" Property="Background">
                                            <Setter.Value>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Offset="0" Color="#CFD8DC" />
                                            <GradientStop Offset="1" Color="#ECEFF1" />
                                            </LinearGradientBrush>
                                            </Setter.Value>
                                            </Setter>-->
                                            <Setter TargetName="Border" Property="BorderThickness" Value="2" />
                                            <Setter TargetName="Border" Property="Opacity" Value="1" />
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Border" Property="Opacity" Value="1" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel
                            HorizontalAlignment="Stretch"
                            Cursor="Hand"
                            Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <WrapPanel>
                            <Grid MinWidth="120">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    VerticalContentAlignment="Center">
                                    <Rectangle
                                        Width="20"
                                        Height="20"
                                        Margin="8,0,0,0"
                                        VerticalAlignment="Center"
                                        Fill="{Binding Converter={StaticResource SocialNetworkToColorBrushConverter}}">
                                        <Rectangle.Style>
                                            <Style TargetType="Rectangle">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding}" Value="{x:Static enums:SocialNetworks.Social}">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Rectangle.Style>
                                        <Rectangle.OpacityMask>
                                            <VisualBrush Stretch="Fill" Visual="{Binding Converter={StaticResource SocialNetworkToVisualBrushConverter}}" />
                                        </Rectangle.OpacityMask>
                                    </Rectangle>
                                </Label>
                                <Label
                                    Grid.Column="1"
                                    VerticalAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    Content="{Binding}"
                                    FontSize="16"
                                    FontWeight="DemiBold">
                                    <Label.Style>
                                        <Style TargetType="Label">
                                            <Setter Property="Foreground" Value="{DynamicResource TextColorBrushAccordingTheme}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListViewItem}, Path=IsSelected}" Value="True">
                                                    <Setter Property="Foreground" Value="{DynamicResource TextColorBrushAccordingTheme1}">
                                                        <!--<Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Offset="0.0" Color="#065265" />
                                                        -->
                                                        <!--  Amber  -->
                                                        <!--
                                                        <GradientStop Offset="1.0" Color="#FF673AB7" />
                                                        -->
                                                        <!--  Deep Purple  -->
                                                        <!--
                                                        </LinearGradientBrush>
                                                        </Setter.Value>-->
                                                    </Setter>
                                                    <!--  Selected color  -->
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Label.Style>
                                </Label>
                            </Grid>
                        </WrapPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Grid x:Name="MainGridContainer" Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30*" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="{Binding PerfCounterViewModel.LogViewHeight, Mode=TwoWay}" MaxHeight="430" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                <!--  Account Growth Mode Tabs  -->
                <TabControl
                    Grid.Row="0"
                    Margin="5"
                    VerticalAlignment="Stretch"
                    controls:TabControlHelper.Underlined="None"
                    BorderThickness="0"
                    ItemContainerStyle="{DynamicResource TabItemStyle}"
                    ItemsSource="{Binding TabItems.ItemsCollection}"
                    SelectedItem="{Binding TabItems.Selected}"
                    TabStripPlacement="{Binding TabDock}"
                    Template="{DynamicResource TopTabstyle}">
                    <TabControl.Style>
                        <Style TargetType="TabControl">
                            <Style.Triggers>
                                <Trigger Property="TabStripPlacement" Value="Left">
                                    <Setter Property="Template" Value="{DynamicResource LeftTabstyle}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TabControl.Style>
                    <TabControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type models:TabItemTemplates}">
                            <TextBlock Text="{Binding Title}" />
                        </DataTemplate>
                    </TabControl.ItemTemplate>
                    <TabControl.ContentTemplate>
                        <DataTemplate DataType="{x:Type models:TabItemTemplates}">
                            <Grid>
                                <UserControl
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Content="{Binding Content.Value}" />
                            </Grid>
                        </DataTemplate>
                    </TabControl.ContentTemplate>
                </TabControl>


                <GridSplitter
                    Grid.Row="1"
                    Height="3.5"
                    Margin="10,5"
                    HorizontalAlignment="Stretch"
                    Background="{DynamicResource TextColorBrushAccordingTheme1}"
                    IsEnabled="{Binding IsEnabled, ElementName=statusbar}"
                    ResizeBehavior="BasedOnAlignment"
                    ResizeDirection="Rows" />

                <Grid
                    Name="Logger"
                    Grid.Row="2"
                    Margin="10,5">
                    <views:LogView
                        x:Name="RootLayout"
                        AvailableAccounts="{Binding AccountList, Mode=OneWay}"
                        AvailableNetworks="{Binding AvailableNetworks.ItemsCollection, Mode=OneWay}"
                        MouseDoubleClick="InitialTabablzControl_MouseDoubleClick"
                        ViewModel="{Binding LogViewModel, Mode=OneWay}" />
                </Grid>
                <Grid
                    Grid.Row="3"
                    Margin="10,5"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom">
                    <!--<views1:PerfCounterView ViewModel="{Binding PerfCounterViewModel, Mode=OneWay}" x:Name="statusbar"/>-->
                    <ContentControl x:Name="statusbar" regions:RegionManager.RegionName="PerfCounterRegion" />
                </Grid>

            </Grid>
        </Grid>
    </Border>
</Window>